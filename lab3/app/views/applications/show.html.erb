<!-- app/views/applications/show.html.erb -->

<h1>Recommendation Details</h1>

<p>Application ID: <%= @application.id %></p>
<p>Name: <%= @name %></p>
<h2>Recommendations</h2>
<br>

<% recommendations = Recommend.where(student_email: @application.student_email) %>

<table>
  <thead>
    <tr>
      <th>Course</th>
      <th>Recommended by</th>
      <th>Faculty Email</th>
      <th></th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% if recommendations.exists? %>
        <% recommendations.each do |recommendation| %>
            <tr>
                <td>CSE <%= Course.find_by(course_id: recommendation.course_id).catalog_number %></td>
                <% faculty = Person.find_by(email: recommendation.faculty_email) %>
                <td><%= faculty.first_name + " " + faculty.last_name %></td>
                <td><%= recommendation.faculty_email %></td>
            </tr>
        <% end %>
    <% else %>
        <p>No recommendations available.</p>
    <% end %>
  </tbody>
</table>

<h2>Upcomming Semester Recommendations</h2>

<% requests = Request.where(student_email: @application.student_email) %>

<table>
  <thead>
    <tr>
      <th>Course</th>
      <th>Section ID</th>
      <th>Semester</th>
      <th>Recommended by</th>
      <th>Faculty Email</th>
      <th>Status</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% if requests.exists? %>
        <% requests.each do |request| %>
            <tr>
                <td>CSE <%= Course.find_by(course_id: request.course_id).catalog_number %></td>
                <td><%= request.section_id %></td>
                <td><%= Section.find_by(s_id: request.section_id).semester_code %></td>
                <% faculty = Person.find_by(email: request.faculty_email) %>
                <td><%= faculty.first_name + " " + faculty.last_name %></td>
                <td><%= request.faculty_email %></td>
                <td><%= request.status %></td>
            </tr>
        <% end %>
    <% else %>
        <p>No recommendations available.</p>
    <% end %>
  </tbody>
</table>

<br><br><br>
<div>
  <%= link_to "Back", applications_path %>
</div>
<br><br><br>


<div>
  <%= link_to "Back to courses", courses_path %>
</div>
